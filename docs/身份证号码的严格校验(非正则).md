
## å‰è¨€
æœ€è¿‘åœ¨å·¥ä½œä¸­éœ€è¦å¯¹ç”¨æˆ·çš„èº«ä»½è¯å·ç è¿›è¡Œå¼ºæ ¡éªŒ(ä¸¥æ ¼æ ¡éªŒ),ç„¶åç”¨äºå®åè®¤è¯ã€‚çœ‹åˆ°è¿™ä¸ªéœ€æ±‚æ—¶,æˆ‘å¿ƒæƒ³è¿™è¿˜ä¸ç®€å•,ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼å°±å¯ä»¥æå®šäº†ã€‚ä½†æ˜¯æƒ³æ³•å¾ˆç¾å¥½,ç°å®å¾ˆæ®‹é…·,ç‹ ç‹ çš„æŠ½äº†æˆ‘ä¸€ä¸ªå¤§å˜´å·´å­...

å› æ­¤èŒç”Ÿäº†å†™ä¸‹ä¸€ç¯‡åšå®¢,é˜²æ­¢åé¢çš„ç«¥é‹å’Œæˆ‘ä¸€æ ·è¢«ç°å®æŠ½äº†ä¸ªå¤§å¤§çš„å˜´å·´...

è™½ç„¶ä¸çŸ¥é“è¿™ç¯‡åšå®¢ä¼šè¢«å¤šå°‘äººçœ‹åˆ°,æ€»å½’èƒ½å¸®ä¸€ä¸ªæ˜¯ä¸€ä¸ªğŸ¤ª,çŠŠå­æ‰¯å®Œäº†å¼€å§‹æ­£æ–‡å†…å®¹äº†;
## åºè¨€
æœ¬æ–‡ä½¿ç”¨çš„JDKç‰ˆæœ¬ä¸º1.8.0_291ï¼ŒIntelliJ IDEAç‰ˆæœ¬ä¸ºIntelliJ IDEA 2021.1.3 (Ultimate Edition) å†…éƒ¨ç‰ˆæœ¬å· #IU-211.7628.21ï¼ŒJune 29, 2021 æ„å»ºã€‚

æœ¬æ–‡åŒ…å«å¤§é‡æ•°å­¦å…¬å¼å’ŒJavaä»£ç ï¼Œæ‰‹æœºç«¯æµè§ˆä½“éªŒè¾ƒå·®ï¼Œå»ºè®®åœ¨ PC ç«¯æˆ– PAD ç«¯æµè§ˆã€‚å¦å¤–,æœ¬æ–‡å‚è€ƒäº†ä¸€äº›æ³•å¾‹æ¡æ–‡ã€ä¸­åäººæ°‘å…±å’Œå›½å›½å®¶æ ‡æ³¨(GBã€GB/T)ä»¥åŠ ISO/IEC æ ‡å‡†,æ„Ÿå…´è¶£çš„ç«¥é‹å¯ä»¥ä»æ–‡æœ«**å‚è€ƒèµ„æ–™**é‡Œé¢ç›´è¾¾.
## ä¸€ã€èº«ä»½è¯å·ç ä»‹ç»
æ ¹æ®æœ€æ–°ä¿®è®¢çš„ã€Šä¸­åäººæ°‘å…±å’Œå›½å±…æ°‘èº«ä»½è¯æ³•ã€‹ç¬¬äºŒåä¸‰æ¡è§„å®šï¼Œä¾ç…§ã€Šä¸­åäººæ°‘å…±å’Œå›½å±…æ°‘èº«ä»½è¯æ¡ä¾‹ã€‹é¢†å–çš„å±…æ°‘èº«ä»½è¯ï¼Œè‡ª2013å¹´1æœˆ1æ—¥èµ·åœæ­¢ä½¿ç”¨ã€‚å³ä¸€ä»£èº«ä»½è¯å·²äº2013å¹´1æœˆ1æ—¥èµ·åœæ­¢ä½¿ç”¨ï¼Œä½†ä»æœ‰éƒ¨åˆ†äººåœ¨ä½¿ç”¨ä¸€ä»£è¯ä»¶ï¼Œå’±ä½œä¸ºä¸€ä¸ªæŠ€æœ¯äººå‘˜å½“ç„¶ä¸èƒ½æŠ›ä¸‹è¿™ä¸€å°éƒ¨åˆ†äººå•¦ã€‚
### 1.èº«ä»½è¯å·ç ç»„æˆ
åœ¨ä»‹ç»èº«ä»½è¯å·ç ç»„æˆä¹‹å‰ï¼Œæˆ‘å…ˆæ”¾å¼ å›¾åœ¨ä¸‹é¢ï¼Œæ–¹ä¾¿ç­‰ä¸‹ä»‹ç»æ—¶å¯¹ç…§æŸ¥çœ‹ã€‚
![èº«ä»½è¯å·ç ç»„æˆ](https://drawing-bot.oss-cn-beijing.aliyuncs.com/bot-images/202304271433154.png)
    
<center>å›¾ 1-1 èº«ä»½è¯å·ç ç»„æˆ</center>
    
ä»å›¾ 1-1 å¯ä»¥çœ‹å‡ºä¸ç®¡æ˜¯ 15 ä½èº«ä»½è¯å·ç è¿˜æ˜¯ 18 ä½èº«ä»½è¯å·ç ï¼Œå®ƒä»¬éƒ½æœ‰**åŒºåŸŸä»£ç **ä¹Ÿå«åœ°å€ç å’Œ**é¡ºåºç **ã€‚è€Œè¿™ä¸¤ç§è¯ä»¶å·ç ä¸åŒçš„åœ¨äº**ç”Ÿæ—¥**å’Œ**æ ¡éªŒç **ã€‚
### 2.çœä»½è¯å·ç ä¸­çš„åè¯è§£é‡Š
#### 1.åŒºåŸŸä»£ç ï¼ˆåœ°å€ç ï¼‰
åŒºåŸŸä»£ç è¡¨ç¤ºç™»è®°æˆ·å£æ—¶ï¼ˆæˆ–å‡ºç”Ÿæ—¶ï¼‰æ‰€åœ¨åœ°çš„è¡Œæ”¿åŒºåˆ’ä»£ç ï¼Œä¸éšæˆ·ç±æ‰€åœ¨åœ°å˜åŠ¨è€Œæ”¹å˜ï¼Œä¾ç…§ã€Šä¸­åäººæ°‘å…±å’Œå›½è¡Œæ”¿åŒºåˆ’ä»£ç ã€‹å›½å®¶æ ‡å‡†ï¼ˆGB/T2260ï¼‰çš„è§„å®šæ‰§è¡Œã€‚
    
åŒºåŸŸä»£ç æ˜¯èº«ä»½è¯å·ç çš„ 1-6 ä½ï¼Œå‰ä¸¤ä½è¡¨ç¤ºçœä»½ï¼ˆç›´è¾–å¸‚ï¼Œè‡ªæ²»åŒºï¼Œç‰¹åˆ«è¡Œæ”¿åŒºï¼‰ï¼›ç¬¬ 3ï¼Œ4 ä½è¡¨ç¤ºå¸‚ï¼ˆåœ°åŒºã€è‡ªæ²»å·ã€ç›Ÿï¼‰ï¼Œç¬¬ 5ï¼Œ6 ä½è¡¨ç¤ºå¿ï¼ˆè‡ªæ²»å¿ã€å¿çº§å¸‚ã€æ——ã€è‡ªæ²»æ——ã€å¸‚è¾–åŒºã€æ—åŒºã€ç‰¹åŒºï¼‰ã€‚ä¾‹å¦‚åŒ—äº¬å¸‚å¸‚è¾–åŒºä¸œåŸåŒºçš„åŒºåŸŸä»£ç ä¸ºï¼š110101ï¼›
å•°å—¦ä¸€å¥ï¼Œå…³äºåœ°å€ç ç¬”è€…å·²ç»ä¸Šä¼ åˆ°äº†èµ„æºä¸­å¯ä»¥ç‚¹å‡»[åŒºåŸŸç®€ç ](https://download.csdn.net/download/qq_22926739/20083779)æˆ–[åŒºåŸŸå…¨ç ](https://download.csdn.net/download/qq_22926739/20083764)ä¸‹è½½ä½¿ç”¨ï¼Œæ–‡ä»¶æ ¼å¼ä¸º json
    
#### 2.ç”Ÿæ—¥
ç”Ÿæ—¥ï¼ˆå‡ºç”Ÿæ—¥æœŸç ï¼‰è¡¨ç¤ºç¼–ç å¯¹è±¡ï¼ˆå…¬æ°‘ï¼‰å‡ºç”Ÿçš„å¹´ã€æœˆã€æ—¥ï¼ŒæŒ‰å›½æ ‡GB/T 7408çš„è§„å®šæ‰§è¡Œï¼Œå¹´ã€æœˆã€æ—¥ä»£ç ä¹‹é—´ä¸ç”¨åˆ†éš”ç¬¦ã€‚ä¸€ä»£è¯ä»¶å·ç ä¸­è¡¨ç¤ºç”Ÿæ—¥æ—¶é‡‡ç”¨çš„æ˜¯ yyMMdd çš„æ ¼å¼ï¼Œè€Œåœ¨äºŒä»£è¯ä»¶ä¸­åˆ™é‡‡ç”¨ yyyyMMdd çš„æ ¼å¼ï¼Œè¿™é‡Œåœ¨åšæ ¡éªŒçš„æ—¶å€™è¦æ³¨æ„ã€‚
#### 3.é¡ºåºç 
é¡ºåºç è¡¨ç¤ºåœ¨åŒä¸€åœ°å€ç æ‰€æ ‡è¯†çš„åŒºåŸŸèŒƒå›´å†…ï¼Œå¯¹åŒå¹´ã€åŒæœˆã€åŒæ—¥å‡ºç”Ÿçš„äººç¼–å®šçš„é¡ºåºå·ï¼Œé¡ºåºç çš„å¥‡æ•°åˆ†é…ç»™ç”·æ€§ï¼Œå¶æ•°åˆ†é…ç»™å¥³æ€§ã€‚ç»†å¿ƒçš„åŒå­¦çœ‹åˆ°è¿™é‡Œå¯èƒ½ä¼šæƒ³é¡ºåºç çš„æœ€å¤§å®¹é‡æ˜¯ 1000ï¼Œè€ŒåŒºåˆ†ç”·å¥³åæœ€å¤§å®¹é‡ä¸º 500ï¼Œå“ªç¬¬ 501 ä¸ªäººå’‹åŠï¼Ÿå…¶å®è¿™ä¸ªå®Œå…¨æ²¡å¿…è¦æ‹…å¿ƒï¼ˆæ ç²¾åŒå­¦è¯·å‡ºé—¨å·¦è½¬ï¼‰åœ¨åˆ¶å®šè§„åˆ™çš„æ—¶å€™å·²ç»æ ¹æ®æˆ‘å›½çš„äººå£ç°çŠ¶ï¼Œå„åŒºå¿åœ¨ä»¥å¾€å†å¹´çš„å‡ºç”Ÿäººå£ç»Ÿè®¡åˆ†æä¸­ç¡®è®¤ï¼Œæ‰€æœ‰åŒºå¿çš„ä¸€å¤©åŒæ€§åˆ«å‡ºç”Ÿäººå£è¿œè¿œè¾¾ä¸åˆ°500ä¸ªä¹‹å¤šã€‚
#### 4.æ ¡éªŒç 
æ ¡éªŒç é‡‡ç”¨ISO 7064:1983,MOD 11-2æ ¡éªŒç®—æ³•å¯¹å‰é¢çš„åœ°å€ç ã€å‡ºç”Ÿæ—¥æœŸç å’Œé¡ºåºç è¿›è¡Œæ ¡éªŒï¼Œç”±äºèº«ä»½è¯å·ç çš„æœ¬ä½“ç ï¼ˆåŒºåŸŸä»£ç +ç”Ÿæ—¥+é¡ºåºç ï¼‰å¤ªé•¿ï¼ˆä¸€ä»£è¯ä¸º 15 ä½ï¼ŒäºŒä»£è¯ä¸º 17 ä½ï¼‰ï¼Œä¸ºäº†é˜²æ­¢äººå·¥å½•å…¥æ˜¯å°†èº«ä»½è¯å·ç è¾“å…¥é”™è¯¯å¼•å…¥äº†æ ¡éªŒç ã€‚
æ ¡éªŒç çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š
    $$
    \sum_{i=1}^{18}\left(a_{i} \times W_{i}\right) \equiv 1(\bmod 11) 
    $$
    å…·ä½“è®¡ç®—é€»è¾‘ä¸‹ä¸€ç« æ¥èŠèŠã€‚
    ### æ€»ç»“
    1. ä¸€ä»£è¯å’ŒäºŒä»£è¯éƒ½æœ‰åœ°å€ç å’Œé¡ºåºç ã€‚
    2. ä¸€ä»£è¯çš„ç”Ÿæ—¥æ˜¯ yyMMdd æ ¼å¼è€ŒäºŒä»£è¯åˆ™æ˜¯ yyyyMMdd æ ¼å¼ã€‚
    3. ä¸€ä»£è¯æ²¡æœ‰æ ¡éªŒç ï¼ŒäºŒä»£è¯æœ‰æ ¡éªŒç ã€‚
    
## äºŒã€æ ¡éªŒç è®¡ç®—
### 1.å…¬å¼æ‹†è§£
å…ˆæ‹†è§£ä¸€ä¸‹æ ¡éªŒç è®¡ç®—å…¬å¼ï¼š
    $$
    \sum_{i=1}^{18}\left(a_{i} \times W_{i}\right) \equiv 1(\bmod 11) 
    $$

- iè¡¨ç¤ºå·ç å­—ç¬¦<font color="red">***ä»å³è‡³å·¦***</font>åŒ…æ‹¬æ ¡éªŒç å­—ç¬¦åœ¨å†…çš„ä½ç½®åºå·ï¼›

- a~i~ è¡¨ç¤ºç¬¬iä½ç½®ä¸Šçš„å·ç å­—ç¬¦å€¼,å¦‚a~1~ æ˜¯èº«ä»½è¯å·ç ç¬¬18ä½æ ¡éªŒç ï¼›
    
- W~i~ è¡¨ç¤ºiä½ç½®ä¸Šçš„åŠ æƒå› å­ï¼ŒåŠ æƒå› å­è®¡ç®—å…¬å¼ï¼š
  $$
  W_{i} = 2^{i-1} (\bmod 11)
  $$

    >å…¬å¼çš„å«ä¹‰ï¼šåŠ å…¥æ ¡éªŒç åï¼Œèº«ä»½å·ç æ‰€æœ‰ä½ç½®ï¼ˆåŒ…æ‹¬æ ¡éªŒç ï¼‰ä¸Šçš„æ•°å­—ä¹˜ä»¥è¯¥ä½ç½®ä¸Šçš„åŠ æƒå› å­å†æ±‚å’Œï¼Œå†å¯¹11æ±‚æ¨¡ï¼Œå…¶ç»“æœè¦ç­‰äº1ã€‚
    
ä¿—è¯è¯´å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œä¸‹é¢æˆ‘ä»¬å°±ç”¨å›¾ 1-1 ä¸­çš„çœä»½è¯å·ç æ¥è®¡ç®—ä¸€ä¸‹ï¼ˆPSï¼šå›¾é‡Œé¢çš„èº«ä»½è¯å·ç æ˜¯éŸ¦å°å®çš„ğŸ¤“ï¼‰
### 2.è¿ç®—
æˆ‘è¿™é‡Œä¸ºäº†ä½¿è¡¨æ ¼å°½é‡å¥½çœ‹äº›ï¼Œåºå· i æˆ‘ä½¿ç”¨ä¸¤ä½è¡¨ç¤ºï¼Œè®¡ç®—ä¸­ä¸éœ€è¦è¿™ä¹ˆåšï¼ï¼ï¼
1. æ ¹æ®åŠ æƒå› å­è®¡ç®—å…¬å¼è®¡ç®—åŠ æƒå› å­

| i    | 18 | 17 | 16 | 15 | 14 | 13 | 12 | 11 | 10 | 09 | 08 | 07 | 06 | 05 | 04 | 03 | 02 | 01 |
|------|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|
| W~i~ | 7  | 9  | 10 | 5  | 8  | 4  | 2  | 1  | 6  | 3  | 7  | 9  | 10 | 5  | 8  | 4  | 2  | 1  |

2. å˜æ¢å…¬å¼
    å·²çŸ¥ 
    $$
    W_{i} = 2^{i-1}  (\bmod  11)
    $$
    
    é‚£ä¹ˆå°†
    $$
    a_{1} * W_{1}
    $$
    
    ä»å…¬å¼ä¸­æå–å‡ºæ¥ï¼Œé‚£ä¹ˆæ ¡éªŒå…¬å¼å°±å˜ä¸ºï¼š
$$
a_{1} * W_{1} + \sum_{i=2}^{18}\left(a_{i} \times W_{i}\right) \equiv 1(\bmod 11)
$$
ç„¶åè®¡ç®—
$$
W_{1} = 2^{1-1} (\bmod 11) = 1
$$
å¼å¯ä»¥å˜ä¸ºï¼š
$$
a_{1} + \sum_{i=2}^{18}\left(a_{i} \times W_{i}\right) \equiv 1(\bmod 11) 
$$

3. æ ¹æ®**å…¬å¼ 2**è®¡ç®—å‡º 2-18  ä½çš„å€¼å¹¶æ¢ç®—å‡ºæ ¡éªŒç ï¼ˆa~1~ï¼‰çš„å€¼ï¼Œå°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹è¡¨çš„æ¢ç®—å…³ç³»è¡¨ï¼š

| i    | 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| a1   | 1    | 0    | X    | 9    | 8    | 7    | 6    | 5    | 4    | 3    | 2    |

çœ‹åˆ°è¿™ä¸ªè¡¨è‚¯å®šæœ‰ä¸å°‘ç«¥é‹è¦é—®ï¼Œä¸Šé¢è¿™ä¸ªæ¢ç®—è¡¨æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿé¦–å…ˆå›½æ ‡è§„å®šäº†æ ¡éªŒç çš„å€¼ä¸º 0-10ï¼ˆå½“ a~1~ =10æ—¶ç”¨ç½—é©¬å­—ç¬¦ X è¡¨ç¤º); ç„¶åä»¥æœ€å³è¾¹çš„ 10 ä¸¾ä¾‹è¯´æ˜ä¸€ä¸‹ï¼š
$$
a_{1} + 10 \equiv 1(\bmod 11) 
$$
å–å€¼èŒƒå›´åœ¨ 0-10 ä¹‹é—´çš„åªæœ‰ 2ï¼Œæ‰€ä»¥ 10 æ¢ç®—åä¸º 2ï¼›ç®€è€Œè¨€ä¹‹å°±æ˜¯å–å€¼èŒƒå›´åœ¨ 0-10 ä¹‹é—´ a~1~ + å…¬å¼ 2 çš„å€¼ = 11*n+1.

4. æœ‰äº†ä¸Šé¢çš„å‡†å¤‡å·¥ä½œä¸‹é¢å¯ä»¥æ­£å¼å°è¯•ä¸€ä¸‹è®¡ç®—äº†
 - åˆ—å‡ºå¯¹åº”æ•°æ®è¡¨ï¼š

| i       | 18 | 17 | 16 | 15 | 14 | 13 | 12 | 11 | 10 | 09 | 08 | 07 | 06 | 05 | 04 | 03 | 02 | 01   |
|---------|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|----|------|
| ai      | 1  | 1  | 2  | 0  | 4  | 4  | 1  | 6  | 5  | 4  | 1  | 2  | 2  | 0  | 2  | 4  | 3  | a~1~ |
| Wi      | 7  | 9  | 10 | 5  | 8  | 4  | 2  | 1  | 6  | 3  | 7  | 9  | 10 | 5  | 8  | 4  | 2  | 1    |
| ai * Wi | 7  | 9  | 20 | 0  | 32 | 16 | 2  | 6  | 30 | 12 | 7  | 18 | 20 | 0  | 16 | 16 | 6  | a~1~ |

- å¯¹ai * Wiæ±‚å’Œï¼š

$$
 \sum_{i=2}^{18}\left(a_{i} \times W_{i}\right) = 217
$$
 - å¯¹11å–æ¨¡ï¼š
$$
 \sum_{i=2}^{18}\left(a_{i} \times W_{i}\right) = 217ï¼ˆmod 11ï¼‰= 8
$$
 - æ±‚å‡ºæ ¡éªŒç å­—ç¬¦å€¼ï¼š
$$
 8+a_{1} \equiv 1(\bmod 11)     =>  9+a_{1} = 11*n
$$
å½“ n=1 æ—¶ï¼Œa1 = 2,æ»¡è¶³å–å€¼èŒƒå›´åœ¨ [0,10];
		å½“ n=2 æ—¶ï¼Œa1 = 12ï¼Œä¸æ»¡è¶³å–å€¼èŒƒå›´åœ¨ [0,10];
		å› æ­¤ a1 = 2, æŸ¥è¡¨æ£€éªŒç ä¸º X

## ä¸‰ã€å®ç°æ€è·¯
### 1.ä¼ªä»£ç 
é€šè¿‡ä¸Šé¢å¯¹èº«ä»½è¯å·ç çš„ä»‹ç»å¯ä»¥å‘ç°ï¼Œè¦å¯¹èº«ä»½è¯å·ç è¿›è¡Œæ ¡éªŒè¦æ ¡éªŒä»¥ä¸‹å‡ ç‚¹ï¼ˆä¼ªä»£ç å…ˆææï¼‰ï¼š
1. 15 ä½èº«ä»½è¯å·ç è½¬åŒ–ä¸º 18 ä½ï¼ˆæ­¤å¤„ä¸è€ƒè™‘ 1900 å¹´åŠä¹‹å‰å‡ºç”Ÿçš„äººï¼‰
2. åŒºåŸŸç ä¸**ä¸­åäººæ°‘å…±å’Œå›½å›½å®¶æ ‡å‡† GB/T 2260-2007 ä¸­åäººæ°‘å…±å’Œå›½è¡Œæ”¿åŒºåˆ’ä»£ç **æ˜¯å¦ç›¸åŒ¹é…ï¼›

```text
Map<String,String> map = getAreaCode();// è·å–åŒºåŸŸç ä¸è¡Œæ”¿åŒºåŸŸçš„å…³ç³»é›†åˆ
String areaCode = idNumber.substring(0,6);
if(map.get(areaCode) != null){
	return true;
}else{
	return false;
}
```

3. ç”Ÿæ—¥è¦ç¬¦åˆè§„èŒƒ

```text
String year = idNumber.substring(6,10);
String mouth = idNumber.substring(10,12);
String day = idNumber.substring(12,14);
if(year+"-"+mouth+"-"+day>new Date()){
//è¿™ä¸ªäººè¿˜æ²¡å‡ºç”Ÿå‘¢
	return false;
} else{
	if(å¹´ä»½å·®>150){
		// å“ªé‡Œæ¥è€å¯¿æ˜Ÿ  æˆ‘æ²¡è§è¿‡
		return false;
	}
	if(mouth>12||mouth<=0){
		// ä»€ä¹ˆå¤­å¯¿æ•°æ® æˆ–è®¸åœ¨åœ°çƒå¤–å‡ºç”Ÿçš„å§
		return false;
	}
	if(day>31 || day<=0){
		//å•Šè¿™... å¤§ä½¬ ä½ æ˜¯å“ªä¸ªæ˜Ÿçƒçš„ï¼Ÿ
		return false;
	}
	// 2 æœˆä»½æ˜¯ä¸ªå‘
	if(æ˜¯é—°å¹´ && mouth==2 && day>29){
		// åˆæ˜¯ä¸ªå¤–æ˜Ÿäºº
		return false;
	}else if(ä¸æ˜¯é—°å¹´ && mouth==2 && day>28){
		// æ±‚æ”¾è¿‡  åœ¨æ¥è§¦å¤–æ˜Ÿäººæ€•æ˜¯è¦è¢«æ‹‰å»åšå®éªŒäº†
		return false;
	}
}
```

4. é€šè¿‡æœ¬ä½“ç è®¡ç®—å‡ºçš„æ ¡éªŒç è¦ä¸èº«ä»½è¯å·ç ä¸­çš„æ ¡éªŒç ç›¸åŒ¹é…

### 2.ä»£ç å®ç°

ä»£ç é‡Œé¢å†™äº†å¾ˆå¤šæ³¨é‡Šï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ï¼Œæœ‰é—®é¢˜å¯ä»¥éšæ—¶è”ç³»æˆ‘ã€‚
 1.æ ¡éªŒé€»è¾‘å·¥å…·ç±»VerifyUtil.javaï¼ˆè¿™é‡Œé¢æˆ‘ä½¿ç”¨å¼‚å¸¸å»å¤„ç†æ ¡éªŒå¤±è´¥çš„æƒ…å†µï¼Œé‚£äº›å¼‚å¸¸å¯æ¢æˆ`return false;`ï¼‰


```java
package club.mooye.service.utils;

import club.mooye.service.enumeration.ErrorCodeEnum;
import club.mooye.service.enumeration.RegularExpressionEnum;
import club.mooye.service.exception.CustomException;
import club.mooye.service.resource.SystemStaticResource;
import lombok.extern.slf4j.Slf4j;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.Objects;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * <h1>VerifyUtil<h1>
 * <p>Copyright (C), æ˜ŸæœŸä¸‰,07,7æœˆ,2021,</p>
 * <br/>
 * <hr>
 * <h3>File Info:</h3>
 * <p>FileName: VerifyUtil</p>
 * <p>Author:   mooye</p>
 * <p>E-mailï¼š curtainldy@163.com</p>
 * <p>Date:     2021/7/7</p>
 * <p>Description: å¤„ç†ä¸€äº›æ ¡éªŒé€»è¾‘</p>
 * <hr>
 * <h3>History:</h3>
 * <hr>
 * <table>
 *  <thead>
 *  <tr><td style='width:100px;' center>ä½œè€…å§“å</td><td style='width:200px;' center>ä¿®æ”¹æ—¶é—´</td><td style='width:100px;' center>ç‰ˆæœ¬å·</td><td style='width:100px;' center>æè¿°</td></tr>
 *  </thead>
 *  <tbody>
 *    <tr><td style='width:100px;' center>mooye</td><td style='width:200px;' center>16:44 2021/7/7</td><td style='width:100px;' center>v_0.0.1</td><td style='width:100px;' center>åˆ›å»º</td></tr>
 *  </tbody>
 * </table>
 * <hr>
 * <br/>
 *
 * @author mooye
 */

@Slf4j
public class VerifyUtil {
    private static final int LONG = 18;
    private static final int SHORT = 15;
    private static final Pattern IS_NUMBER = Pattern.compile("[0-9]*");
    private static final Integer MAX_MONTH = 12;
    private static final Integer ARG_2 = 2;
    private static final Integer ARG_4 = 4;
    private static final Integer ARG_6 = 6;
    private static final Integer ARG_100 = 100;
    private static final Integer ARG_150 = 150;
    private static final Integer ARG_400 = 400;
    
    /**
     * èº«ä»½è¯å·ç åˆæ³•æ€§æ ¡éªŒ
     * @param idCardNumber èº«ä»½è¯å·ç 
     * @return TRUE
     * @throws CustomException ä¸åˆæ³•æ—¶æŠ›å‡º
     * @throws ParseException å­—ç¬¦ä¸²è½¬æ¢å¼‚å¸¸æ—¶æŠ›å‡º
     */
    public static boolean verifyCard(String idCardNumber) throws CustomException, ParseException {
        // åˆ¤æ–­èº«ä»½è¯ä½æ•°æ˜¯å¦ä¸º 15 or 18 ä½
        if (idCardNumber.length() != LONG && idCardNumber.length() != SHORT) {
            log.error("èº«ä»½è¯å·ç é•¿åº¦ä¸æ˜¯ 15/18 ä½!");
            throw new CustomException("èº«ä»½è¯å·ç é•¿åº¦åº”è¯¥ä¸º15ä½æˆ–18ä½", ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // 15 ä½èº«ä»½è¯å·ç è½¬æˆ 18ä½è¿›è¡Œæ ¡éªŒ
        if (idCardNumber.length() == SHORT){
            idCardNumber = idCardNumberConversion(idCardNumber);
        }
        String idNo = idCardNumber.substring(0,LONG-1);
        
        if (!isNum(idNo)){
            log.error("çœä»½è¯å·ç æ ¼å¼é”™è¯¯!");
            throw new CustomException("èº«ä»½è¯å·ç æ ¼å¼é”™è¯¯!",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // æ ¡éªŒç”Ÿæ—¥
        String year = idNo.substring(ARG_6, 10);
        String month = idNo.substring(10, 12);
        String day = idNo.substring(12, 14);
        if (!verifyDate(year,month,day)){
            log.error("ç”Ÿæ—¥æ ¼å¼é”™è¯¯!");
            throw new CustomException("èº«ä»½è¯å·ç æ ¼å¼é”™è¯¯!",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // æ ¡éªŒåœ°åŒºç 
        if (SystemStaticResource.areaCode().get(idNo.substring(0, ARG_6)) == null){
            log.info("åœ°åŒºç é”™è¯¯!");
            throw new CustomException("èº«ä»½è¯å·ç æ ¼å¼é”™è¯¯!",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // åˆ¤æ–­æ ¡éªŒç 
        int theLastCode = 0;
        for (int i = 0; i < LONG-1; i++) {
            theLastCode += Integer.parseInt(String.valueOf(idNo.charAt(i))) * Integer.parseInt(SystemStaticResource.CHECK_CODE[i]);
        }
        int modValue = theLastCode % 11;
        String verifyCode = SystemStaticResource.WF[modValue];
        idNo = idNo + verifyCode;
        if (!Objects.equals(idCardNumber,idNo)){
            log.error("æ ¡éªŒç ä¸åŒ¹é…!");
            throw new CustomException("èº«ä»½è¯æ— æ•ˆï¼Œä¸æ˜¯åˆæ³•çš„èº«ä»½è¯å·ç ",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        return true;
    }
      // ================================ ç§æœ‰é™æ€æ–¹æ³•åŒº ================================ //
    /**
     * 15 ä½èº«ä»½è¯å·è½¬ 18 ä½èº«ä»½è¯å· (æ­¤å¤„ä¸è€ƒè™‘ 1900 å¹´å‡ºç”Ÿçš„è€å¯¿æ˜Ÿ)
     * @param idCardNumber èº«ä»½è¯å·
     * @return è½¬æ¢åçš„èº«ä»½è¯å·
     */
    private static String idCardNumberConversion(String idCardNumber) {
        idCardNumber = idCardNumber.substring(0,6) + "19" + idCardNumber.substring(6,SHORT);
        int theLastCode = 0;
        for (int i = 0; i < idCardNumber.length(); i++) {
            theLastCode += Integer.parseInt(String.valueOf(idCardNumber.charAt(i))) * Integer.parseInt(SystemStaticResource.CHECK_CODE[i]);
        }
        int modValue = theLastCode % 11;
        String verifyCode = SystemStaticResource.WF[modValue];
        idCardNumber = idCardNumber + verifyCode;
        return idCardNumber;
    }
    
    /**
     * åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºçº¯æ•°å­—
     * @param idNo å­—ç¬¦ä¸²
     * @return TRUE | FALSE
     */
    private static boolean isNum(String idNo) {
        Matcher matcher = IS_NUMBER.matcher(idNo);
        return matcher.matches();
    }
    
    /**
     * åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æ»¡è¶³æŒ‡å®šçš„æ—¥æœŸæ ¼å¼
     * @param idNo å­—ç¬¦ä¸²
     * @return TRUE | FALSE
     */
    private static boolean isDate(String idNo) {
        String[] strings = idNo.split("-");
        boolean flag = true;
        for (String string : strings) {
            flag = flag && isNum(string);
        }
        return flag;
    }
    
    /**
     * æ ¡éªŒç”Ÿæ—¥åˆæ³•æ€§
     * @param year ç”Ÿæ—¥-å¹´
     * @param month ç”Ÿæ—¥-æœˆ
     * @param day ç”Ÿæ—¥-æ—¥
     * @return TRUE
     * @throws CustomException FALSE æ—¶æŠ›å‡º
     * @throws ParseException String To Date å‡ºç°å¼‚å¸¸æ—¶æŠ›å‡º
     */
    public static boolean verifyDate(String year, String month, String day) throws CustomException, ParseException {
        String date = year + "-" + month + "-" + day;
        log.info("ç”Ÿæ—¥:{}", date);
        if (!isDate(date)){
            log.error("èº«ä»½è¯ç”Ÿæ—¥æ— æ•ˆ!");
            throw new CustomException("èº«ä»½è¯ç”Ÿæ—¥æ— æ•ˆ",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        SimpleDateFormat simpleDateFormat = new SimpleDateFormat("yyyy-MM-dd");
        long idCardTime = simpleDateFormat.parse(date).getTime();
        long nowTime = simpleDateFormat.parse(simpleDateFormat.format(new Date())).getTime();
        Calendar calendar = new GregorianCalendar();
        if (idCardTime-nowTime>0){
            log.error("å‡ºç”Ÿæ—¥æœŸè¶…è¿‡å½“å‰æ—¥æœŸ!");
            throw new CustomException("èº«ä»½è¯ä¸­çš„æ—¥æœŸä¸åˆæ³•",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // åˆ¤è¯»å¹´ä»½åˆæ³•æ€§
        if (calendar.get(Calendar.YEAR) - Integer.parseInt(year) > ARG_150){
            log.error("å¹´ä»½æ•°æ®ä¸åˆæ³•!");
            throw new CustomException("èº«ä»½è¯ä¸­çš„æ—¥æœŸä¸åˆæ³•",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // åˆ¤æ–­æœˆä»½åˆæ³•æ€§
        if (Integer.parseInt(month)> MAX_MONTH || Integer.parseInt(month) == 0){
            log.error("æœˆä»½æ•°æ®ä¸åˆæ³•!");
            throw new CustomException("èº«ä»½è¯ä¸­çš„æ—¥æœŸä¸åˆæ³•",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        // åˆ¤æ–­æ—¥æ•°æ®,æ³¨æ„ 2 æœˆä»½
        boolean flag1 = Integer.parseInt(day) > 31 || Integer.parseInt(day) <=0;
        boolean flag2 = isLeapYear(Integer.parseInt(year)) && Integer.parseInt(month) ==2 && Integer.parseInt(day) > 29;
        boolean flag3 = !isLeapYear(Integer.parseInt(year)) && Integer.parseInt(month) ==2 && Integer.parseInt(day) > 28;
        if (flag1 || flag2 || flag3 ){
            log.error("æ—¥æœŸæ•°æ®ä¸åˆæ³•!");
            throw new CustomException("èº«ä»½è¯ä¸­çš„æ—¥æœŸä¸åˆæ³•",ErrorCodeEnum.PARAM_ERROR.getCode());
        }
        return true;
    }
    
    /**
     * åˆ¤æ–­æ˜¯å¦ä¸ºé—°å¹´
     * @param year å¹´ä»½
     * @return TRUE | FALSE
     */
    private static boolean isLeapYear(int year){
        boolean flag = false;
        if (year % ARG_4 == 0 && year % ARG_100 != 0){
            flag = true;
        }else if (year % ARG_400 == 0 ){
            flag = true;
        }
        return flag;
    }
}
```


2.é™æ€èµ„æºåŠ è½½ç±»SystemStaticResource.java
```java
package club.mooye.service.resource;

import club.mooye.service.enumeration.ErrorCodeEnum;
import club.mooye.service.exception.CustomException;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import io.swagger.annotations.ApiModelProperty;

import java.io.*;
import java.util.HashMap;
import java.util.Map;
import java.util.Optional;

/**
 * <h1>SystemStaticResource<h1>
 * <p>Copyright (C), æ˜ŸæœŸä¸‰,07,7æœˆ,2021,</p>
 * <br/>
 * <hr>
 * <h3>File Info:</h3>
 * <p>FileName: SystemStaticResource</p>
 * <p>Author:   mooye</p>
 * <p>E-mailï¼š curtainldy@163.com</p>
 * <p>Date:     2021/7/7</p>
 * <p>Description: ç³»ç»Ÿé™æ€èµ„æº</p>
 * <hr>
 * <h3>History:</h3>
 * <hr>
 * <table>
 *  <thead>
 *  <tr><td style='width:100px;' center>ä½œè€…å§“å</td><td style='width:200px;' center>ä¿®æ”¹æ—¶é—´</td><td style='width:100px;' center>ç‰ˆæœ¬å·</td><td style='width:100px;' center>æè¿°</td></tr>
 *  </thead>
 *  <tbody>
 *    <tr><td style='width:100px;' center>mooye</td><td style='width:200px;' center>16:34 2021/7/7</td><td style='width:100px;' center>v_0.0.1</td><td style='width:100px;' center>åˆ›å»º</td></tr>
 *  </tbody>
 * </table>
 * <hr>
 * <br/>
 *
 * @author mooye
 */

public class SystemStaticResource {
    /**
     * æ ¡éªŒç 
     */
    @ApiModelProperty(value = "æ ¡éªŒç ",notes = "èº«ä»½è¯æ ¡éªŒ")
    public static final String[] WF = { "1", "0", "X", "9", "8", "7", "6", "5", "4", "3", "2" };
    /**
     * åŠ æƒå› å­å¸¸æ•°
     */
    @ApiModelProperty(value = "åŠ æƒå› å­å¸¸æ•°",notes = "èº«ä»½è¯æ ¡éªŒ")
    public static final String[] CHECK_CODE = { "7", "9", "10", "5", "8", "4", "2", "1", "6", "3", "7", "9", "10", "5", "8", "4", "2" };
    /**
     * åŠ è½½åŒºåŸŸä»£ç å’Œè¡Œæ”¿åŒºåŸŸå…³ç³»
     * @return string
     */
    private static String readerJsonFile() throws CustomException {
        String areaCode = null;
        String path =
                Optional.ofNullable(SystemStaticResource.class.getClassLoader().getResource("templates/json/areaCode.json")).orElseThrow(
                        ()->new CustomException(ErrorCodeEnum.FILE_NOT_FIND.getMessage(),ErrorCodeEnum.FILE_NOT_FIND.getCode())
                ).getPath();
        try (Reader reader = new InputStreamReader(new FileInputStream(path))) {
            int chore = 0;
            StringBuilder buffer = new StringBuilder();
            while ((chore = reader.read()) != -1) {
                buffer.append((char) chore);
            }
             areaCode = buffer.toString();
        } catch (IOException e) {
            e.printStackTrace();
        }
        return areaCode;
    }
    
    /**
     * å•ä½å¹´è½¬åŒ–ä¸ºå•ä½æœˆ
     */
    @ApiModelProperty("å•ä½å¹´è½¬åŒ–ä¸ºå•ä½æœˆ")
    public static final int YEAR_TO_MOUTH = 12;
    /**
     * å•ä½å‘¨è½¬åŒ–ä¸ºå•ä½æ—¥
     */
    @ApiModelProperty("å•ä½å‘¨è½¬åŒ–ä¸ºå•ä½æ—¥")
    public static final int WEEK_TO_DAY = 7;
    /**
     * å•ä½æ—¥è½¬åŒ–ä¸ºå•ä½æ—¶
     */
    @ApiModelProperty("å•ä½æ—¥è½¬åŒ–ä¸ºå•ä½æ—¶")
    public static final int DAY_TO_HOUR = 24;
    /**
     * å•ä½æ—¶è½¬åŒ–ä¸ºå•ä½åˆ†é’Ÿ
     */
    @ApiModelProperty("å•ä½æ—¶è½¬åŒ–ä¸ºå•ä½åˆ†é’Ÿ")
    public static final int HOUR_TO_MINUTE = 60;
    /**
     * å•ä½åˆ†è½¬åŒ–ä¸ºå•ä½ç§’
     */
    @ApiModelProperty("å•ä½åˆ†è½¬åŒ–ä¸ºå•ä½ç§’")
    public static final int MINUTE_TO_SECOND = 60;
    /**
     * å•ä½ç§’è½¬åŒ–ä¸ºå•ä½æ¯«ç§’
     */
    @ApiModelProperty("å•ä½ç§’è½¬åŒ–ä¸ºå•ä½æ¯«ç§’")
    public static final int SECOND_TO_MILLI_SECOND = 1000;
    
    /**
     * åœ°åŒºç 
     * @return åœ°åŒºç é›†åˆ
     */
    public static Map<String,String> areaCode() throws CustomException {
        String areaCode = readerJsonFile();
        if (areaCode == null){
            throw new CustomException(ErrorCodeEnum.PARAM_NULL.getMessage(),ErrorCodeEnum.PARAM_NULL.getCode());
        }
        Map<String,String> map = new HashMap<>(16);
        JSONArray array = JSONObject.parseObject(areaCode).getJSONArray("areaCode");
        array.forEach(o -> {
            JSONObject json = JSONObject.parseObject(o.toString());
            map.put(json.getString("code"),json.getString("area"));
        });
        return map;
    }
}
```

## å‚è€ƒèµ„æ–™

 1. [ä¸­åäººæ°‘å…±å’Œå›½å±…æ°‘èº«ä»½è¯æ³•](http://www.gov.cn/banshi/2005-08/02/content_19457.htm)
 2. [ä¸­åäººæ°‘å…±å’Œå›½å›½å®¶æ ‡å‡† GB/T 2260-2007 ä¸­åäººæ°‘å…±å’Œå›½è¡Œæ”¿åŒºåˆ’ä»£ç ](http://openstd.samr.gov.cn/bzgk/gb/newGbInfo?hcno=C9C488FD717AFDCD52157F41C3302C6D)
 3. [ä¸­åäººæ°‘å…±å’Œå›½å›½å®¶æ ‡å‡† GB 11643-1999 å…¬æ°‘èº«ä»½è¯å·ç ](http://www.gb688.cn/bzgk/gb/newGbInfo?hcno=080D6FBF2BB468F9007657F26D60013E)
 4. [ä¸­åäººæ°‘å…±å’Œå›½å›½å®¶æ ‡å‡† GB/T 17710-2008 ä¿¡æ¯æŠ€æœ¯ å®‰å…¨æŠ€æœ¯ æ ¡éªŒå­—ç¬¦ç³»ç»Ÿ](http://www.gb688.cn/bzgk/gb/newGbInfo?hcno=AF0D6B2828F0C88CD9A4A56B1EE7AFCA)
 5. [ISO/IEC 7064:2003 Information technology - Security techniques - Check character systems](https://www.iso.org/standard/31531.html)
